# 08-fs模块

fs 是 nodejs 核心模块，提供了文件系统的 API。

![](imgs/2022-02-14-20-45-59.png)

## 权限位

- 用户对文件所具备的操作权限: rwx
- 操作系统对用户分为三类：文件所有者、文件所属组、其他用户

![](imgs/2022-02-14-20-37-38.png)

![](imgs/2022-02-14-20-50-23.png)

windows 默认是 rw, 八进制文件权限表示位 0o666, 十进制表示为 438

## 常见 flag 操作符

- r: 表示可读
- w: 表示可写
- s: 表示同步操作
- +: 表示增加相反操作, 如 r+ 表示可读可写操作(可读 + 相反操作).
- x: 表示排它操作
- a: 表示追加操作

**详细说明**
- r: 表示文件只可读，此时向文件中写入内容会报错
- w: 表示文件只可写，此时读取文件内容会报错
- r+: 表示文件既可读，也可写，如果文件不存在则报错，如果文件存在，每次打开文件时，从文件起始位置开始读写，写的时候会覆盖原有内容，未覆盖部分保留
- w+:表示文件既可读，也可写，如果文件不存在，不会报错，而是自动创建一个文件；如果文件存在，每次打开文件时，会清空原有内容。

## 标识符

fd 就是操作系统分配给被打开文件的标识,由于系统不同, nodejs 将 fd 抽象成了数字，从 3 开始。
0， 1， 2 分别是输入流、输出流、错误流。

为什么需要 open 和 close ?

因为 writeFile、readFile 是一次性加载到内存中的。需要一种流的方式处理文件：打开、读、关闭。

## 大文件读写操作


## 常用 API

- access 查看文件是否有访问权限(或指定权限)，如果没有，则报错。
- stat 获取文件或目录的信息
- mkdir 创建目录，父目录必须存在，否则报错，可以设置 recursive 为 true 递归创建目录。
- rmdir 删除目录，默认只能删除空目录，可以设置 recursive 为 true 删除非空目录。
- readdir 读目录，返回一个由文件或目录组成的数组。
- unlink 删除文件，如果文件不存在则会报错。

### stat

stat 方法用于获取文件的信息，如果文件不存在，会报错。

```js
fs.stat(filepath, (err, stats) => {
  stats.isFile()
  stats.isDirectory()
  stats.isSymbolicLink()
  stats.size // 字节
})
```


- https://nodejs.dev/learn/nodejs-file-stats
